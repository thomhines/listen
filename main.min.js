function setViewportHeight(){const t=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",`${t}px`),cl("Setting viewport height to:",window.innerHeight,"px (--vh:",t,"px)")}cl=console.log,setViewportHeight(),$(document).ready((function(){let t=null,e=null,n=!1,o=!1,i=[],a=new Map,c=0,s=0,r=0,u=0,d=50;async function l(t){const e=t;if(a.has(e))return a.get(e);try{const n=await fetch(t);if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const o=await n.blob(),i=URL.createObjectURL(o);return a.set(e,{blobUrl:i,size:o.size,originalPath:t}),a.get(e)}catch(t){throw t}}function m(t,e,n){if(o)return void i.push({time:e,callback:n});o=!0;const a=!t.paused;a&&t.pause(),t.currentTime=e,setTimeout((()=>{o=!1,a?t.play().then((function(){n(),p()})).catch((function(t){n(),p()})):(n(),p())}),10)}function p(){if(i.length>0&&!o){const e=i.shift();m(t,e.time,e.callback)}}function f(n,a,c){const s=$("#"+n);s.empty(),0!==a.length?a.forEach((function(n){const a=$('<div class="file-item"></div>'),r=n.replace(/\.[^/.]+$/,"");a.html(`\n\t\t\t\t<span class="file-name">${r}</span>\n\t\t\t\t<button class="play-btn" data-file="${n}" data-type="${c}">Play</button>\n\t\t\t`),a.find(".play-btn").on("click",(function(){!async function(n,a){const c=a+"/"+n;if("_audio"===a){i=[],o=!1;const e=n.replace(/\.[^/.]+$/,"");$("#track-title").text(e),b(!1);try{const n=await l(c),o=$("#audio-player")[0];o.src=n.blobUrl,await new Promise(((t,e)=>{o.addEventListener("loadedmetadata",t,{once:!0}),o.addEventListener("error",e,{once:!0}),setTimeout((()=>e(new Error("Metadata loading timeout"))),5e3)})),await o.play(),t=o,$("#track-title").text(e),y(!0),b(!0)}catch(t){$("#track-title").text(e+" (Error)"),b(!1)}}else if("_music"===a)try{const t=await l(c),n=$("#music-player")[0];n.src=t.blobUrl,await new Promise(((t,e)=>{n.addEventListener("loadedmetadata",t,{once:!0}),n.addEventListener("error",e,{once:!0}),setTimeout((()=>e(new Error("Metadata loading timeout"))),5e3)})),await n.play(),e=n,g(!0)}catch(t){}}($(this).data("file"),$(this).data("type")),$(".modal").removeClass("active")})),s.append(a)})):s.append('<p class="no-files">No files found</p>')}function h(){t&&(t.paused?t.play().then((function(){y(!0)})).catch((function(t){})):(t.pause(),y(!1)),v())}function w(e){if(t){const n=Math.max(0,t.currentTime+e);m(t,n,(function(){}))}}function b(t){$("#back-10-btn").prop("disabled",!t),$("#play-pause-btn").prop("disabled",!t),$("#forward-10-btn").prop("disabled",!t)}function v(){const e=$("#play-pause-btn");t&&!t.paused?e.text("⏸"):e.text("▶")}function g(t){const n=$("#music-control-btn");if(e){n.prop("disabled",!1);const t=!e.paused;n.text(t?"⏸":"▶")}else n.prop("disabled",!0),n.text("▶")}function y(t){t?$("#main-player-area").addClass("playing"):$("#main-player-area").removeClass("playing"),v()}function E(){if(!t)return;const e=t.currentTime,n=t.duration;isNaN(e)||isNaN(n)||($("#current-time").text(x(e)),$("#total-time").text(x(n)),$("#track-duration").text(`${x(e)} / ${x(n)}`))}function T(e){if(!t)return;const n=$("#scrubber-bar")[0].getBoundingClientRect(),o=(e.type.includes("touch")?e.touches[0].clientX:e.clientX)-n.left,i=Math.max(0,Math.min(1,o/n.width)),a=i*t.duration;m(t,a,(function(){}));const c=100*i;$("#scrubber-progress").css("width",c+"%"),$("#scrubber-handle").css("left",c+"%"),$("#current-time").text(x(a)),$("#track-duration").text(`${x(a)} / ${x(t.duration)}`)}function x(t){if(isNaN(t))return"00:00";const e=Math.floor(t/60),n=Math.floor(t%60);return`${e.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`}f("audio-files-list",window.audioFiles||[],"_audio"),f("music-files-list",window.musicFiles||[],"_music"),$("#main-player-area").on("click",(function(t){$(t.target).closest("#controls, #top-controls").length||h()})),$("#main-player-area").on("touchstart",(function(t){c=t.originalEvent.touches[0].clientX,s=t.originalEvent.touches[0].clientY})),$("#main-player-area").on("touchend",(function(t){r=t.originalEvent.changedTouches[0].clientX,u=t.originalEvent.changedTouches[0].clientY;const e=r-c,n=u-s;Math.abs(e)>Math.abs(n)&&Math.abs(e)>d&&(t.preventDefault(),w(e>0?-10:10))})),$("#audio-files-btn").on("click",(function(){$("#audio-files-modal").addClass("active")})),$("#music-files-btn").on("click",(function(){$("#music-files-modal").addClass("active")})),$("#back-10-btn").on("click",(function(){w(-10)})),$("#play-pause-btn").on("click",(function(){h()})),$("#forward-10-btn").on("click",(function(){w(10)})),$("#music-control-btn").on("click",(function(){e&&(e.paused?e.play().then((function(){g(!0)})).catch((function(t){})):(e.pause(),g(!1)))})),$("#audio-volume").on("input",(function(){const e=$(this).val()/100;t&&(t.volume=e)})),$("#music-volume").on("input",(function(){const t=$(this).val()/100;e&&(e.volume=t)})),$(".close-btn").on("click",(function(){$(".modal").removeClass("active")})),$(".modal").on("click",(function(t){t.target===this&&$(this).removeClass("active")})),$("#scrubber-bar").on("mousedown touchstart",(function(t){n=!0,T(t)})),$(document).on("mousemove touchmove",(function(t){n&&T(t)})),$(document).on("mouseup touchend",(function(){n&&(n=!1)})),function(){const e=$("#audio-player")[0],o=$("#music-player")[0];e.addEventListener("loadedmetadata",(function(){E()})),e.addEventListener("timeupdate",(function(){E(),function(){if(!t||n)return;const e=t.currentTime,o=t.duration;if(!isNaN(e)&&!isNaN(o)&&o>0){const t=e/o*100;$("#scrubber-progress").css("width",t+"%"),$("#scrubber-handle").css("left",t+"%")}}()})),e.addEventListener("ended",(function(){y(!1)})),o.addEventListener("loadedmetadata",(function(){})),o.addEventListener("ended",(function(){o.currentTime=0,o.play()}))}(),function(){if(/iPad|iPhone|iPod|Android/.test(navigator.userAgent)){const t=()=>{const t=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",`${t}px`),cl("Setting viewport height to:",window.innerHeight,"px (--vh:",t,"px)")};t(),setTimeout(t,50),setTimeout(t,100),window.addEventListener("resize",t),window.addEventListener("orientationchange",(()=>{setTimeout(t,100)})),window.visualViewport&&window.visualViewport.addEventListener("resize",t);let e=0;document.addEventListener("touchend",(function(t){const n=(new Date).getTime();n-e<=300&&t.preventDefault(),e=n}),!1),document.body.addEventListener("touchmove",(function(t){t.target.closest(".modal-body")||t.preventDefault()}),{passive:!1});const n=()=>{window.scrollTo(0,1),setTimeout((()=>{window.scrollTo(0,0)}),50)};n(),setTimeout(n,100),setTimeout(n,500),setTimeout(n,1e3),document.addEventListener("touchstart",n,{passive:!0}),document.addEventListener("touchend",n,{passive:!0}),window.addEventListener("focus",n),window.addEventListener("blur",n),!0===window.navigator.standalone?cl("Running in standalone mode - address bar should be hidden"):cl("Not in standalone mode - add to home screen for full-screen experience"),cl("Viewport height:",window.innerHeight),cl("Document height:",document.documentElement.clientHeight),cl("Body height:",document.body.clientHeight),cl("User agent:",navigator.userAgent);const o=document.querySelector('meta[name="apple-mobile-web-app-capable"]');cl("Web app capable meta:",o?o.content:"not found")}}()}));