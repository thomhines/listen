cl=console.log,$(document).ready((function(){let t=null,n=null,e=!1,a=!1,i=[],o=new Map,c=0,s=0,r=0,u=0,l=50;async function d(t){const n=t;if(o.has(n))return o.get(n);try{const e=await fetch(t);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const a=await e.blob(),i=URL.createObjectURL(a);return o.set(n,{blobUrl:i,size:a.size,originalPath:t}),o.get(n)}catch(t){throw t}}function f(t,n,e){if(a)return void i.push({time:n,callback:e});a=!0;const o=!t.paused;o&&t.pause(),t.currentTime=n,setTimeout((()=>{a=!1,o?t.play().then((function(){e(),p()})).catch((function(t){e(),p()})):(e(),p())}),10)}function p(){if(i.length>0&&!a){const n=i.shift();f(t,n.time,n.callback)}}function m(e,o,c){const s=$("#"+e);s.empty(),0!==o.length?o.forEach((function(e){const o=$('<div class="file-item"></div>'),r=e.replace(/\.[^/.]+$/,"");o.html(`\n\t\t\t\t<span class="file-name">${r}</span>\n\t\t\t\t<button class="play-btn" data-file="${e}" data-type="${c}">Play</button>\n\t\t\t`),o.find(".play-btn").on("click",(function(){!async function(e,o){const c=o+"/"+e;if("_audio"===o){i=[],a=!1;const n=e.replace(/\.[^/.]+$/,"");$("#track-title").text(n),v(!1);try{const e=await d(c),a=$("#audio-player")[0];a.src=e.blobUrl,await new Promise(((t,n)=>{a.addEventListener("loadedmetadata",t,{once:!0}),a.addEventListener("error",n,{once:!0}),setTimeout((()=>n(new Error("Metadata loading timeout"))),5e3)})),await a.play(),t=a,$("#track-title").text(n),g(!0),v(!0)}catch(t){$("#track-title").text(n+" (Error)"),v(!1)}}else if("_music"===o)try{const t=await d(c),e=$("#music-player")[0];e.src=t.blobUrl,await new Promise(((t,n)=>{e.addEventListener("loadedmetadata",t,{once:!0}),e.addEventListener("error",n,{once:!0}),setTimeout((()=>n(new Error("Metadata loading timeout"))),5e3)})),await e.play(),n=e,w(!0)}catch(t){}}($(this).data("file"),$(this).data("type")),$(".modal").removeClass("active")})),s.append(o)})):s.append('<p class="no-files">No files found</p>')}function h(){t&&(t.paused?t.play().then((function(){g(!0)})).catch((function(t){})):(t.pause(),g(!1)),y())}function b(n){if(t){const e=Math.max(0,t.currentTime+n);f(t,e,(function(){}))}}function v(t){$("#back-10-btn").prop("disabled",!t),$("#play-pause-btn").prop("disabled",!t),$("#forward-10-btn").prop("disabled",!t)}function y(){const n=$("#play-pause-btn");t&&!t.paused?n.text("⏸"):n.text("▶")}function w(t){const e=$("#music-control-btn");if(n){e.prop("disabled",!1);const t=!n.paused;e.text(t?"⏸":"▶")}else e.prop("disabled",!0),e.text("▶")}function g(t){t?$("#main-player-area").addClass("playing"):$("#main-player-area").removeClass("playing"),y()}function k(){if(!t)return;const n=t.currentTime,e=t.duration;isNaN(n)||isNaN(e)||($("#current-time").text(x(n)),$("#total-time").text(x(e)),$("#track-duration").text(`${x(n)} / ${x(e)}`))}function E(n){if(!t)return;const e=$("#scrubber-bar")[0].getBoundingClientRect(),a=(n.type.includes("touch")?n.touches[0].clientX:n.clientX)-e.left,i=Math.max(0,Math.min(1,a/e.width)),o=i*t.duration;f(t,o,(function(){}));const c=100*i;$("#scrubber-progress").css("width",c+"%"),$("#scrubber-handle").css("left",c+"%"),$("#current-time").text(x(o)),$("#track-duration").text(`${x(o)} / ${x(t.duration)}`)}function x(t){if(isNaN(t))return"00:00";const n=Math.floor(t/60),e=Math.floor(t%60);return`${n.toString().padStart(2,"0")}:${e.toString().padStart(2,"0")}`}m("audio-files-list",window.audioFiles||[],"_audio"),m("music-files-list",window.musicFiles||[],"_music"),$("#main-player-area").on("click",(function(t){$(t.target).closest("#controls, #top-controls").length||h()})),$("#main-player-area").on("touchstart",(function(t){c=t.originalEvent.touches[0].clientX,s=t.originalEvent.touches[0].clientY})),$("#main-player-area").on("touchend",(function(t){r=t.originalEvent.changedTouches[0].clientX,u=t.originalEvent.changedTouches[0].clientY;const n=r-c,e=u-s;Math.abs(n)>Math.abs(e)&&Math.abs(n)>l&&(t.preventDefault(),b(n>0?-10:10))})),$("#audio-files-btn").on("click",(function(){$("#audio-files-modal").addClass("active")})),$("#music-files-btn").on("click",(function(){$("#music-files-modal").addClass("active")})),$("#back-10-btn").on("click",(function(){b(-10)})),$("#play-pause-btn").on("click",(function(){h()})),$("#forward-10-btn").on("click",(function(){b(10)})),$("#music-control-btn").on("click",(function(){n&&(n.paused?n.play().then((function(){w(!0)})).catch((function(t){})):(n.pause(),w(!1)))})),$("#audio-volume").on("input",(function(){const n=$(this).val()/100;t&&(t.volume=n)})),$("#music-volume").on("input",(function(){const t=$(this).val()/100;n&&(n.volume=t)})),$(".close-btn").on("click",(function(){$(".modal").removeClass("active")})),$(".modal").on("click",(function(t){t.target===this&&$(this).removeClass("active")})),$("#scrubber-bar").on("mousedown touchstart",(function(t){e=!0,E(t)})),$(document).on("mousemove touchmove",(function(t){e&&E(t)})),$(document).on("mouseup touchend",(function(){e&&(e=!1)})),function(){const n=$("#audio-player")[0],a=$("#music-player")[0];n.addEventListener("loadedmetadata",(function(){k()})),n.addEventListener("timeupdate",(function(){k(),function(){if(!t||e)return;const n=t.currentTime,a=t.duration;if(!isNaN(n)&&!isNaN(a)&&a>0){const t=n/a*100;$("#scrubber-progress").css("width",t+"%"),$("#scrubber-handle").css("left",t+"%")}}()})),n.addEventListener("ended",(function(){g(!1)})),a.addEventListener("loadedmetadata",(function(){})),a.addEventListener("ended",(function(){a.currentTime=0,a.play()}))}()}));