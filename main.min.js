cl=console.log,$(document).ready((function(){let t=null,n=null,e=!1,a=!1,i=[],o=new Map;async function c(t){const n=t;if(o.has(n))return o.get(n);try{const e=await fetch(t);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const a=await e.blob(),i=URL.createObjectURL(a);return o.set(n,{blobUrl:i,size:a.size,originalPath:t}),o.get(n)}catch(t){throw t}}function s(t,n,e){if(a)return void i.push({time:n,callback:e});a=!0;const o=!t.paused;o&&t.pause(),t.currentTime=n,setTimeout((()=>{a=!1,o?t.play().then((function(){e(),r()})).catch((function(t){e(),r()})):(e(),r())}),10)}function r(){if(i.length>0&&!a){const n=i.shift();s(t,n.time,n.callback)}}function u(e,o,s){const r=$("#"+e);r.empty(),0!==o.length?o.forEach((function(e){const o=$('<div class="file-item"></div>'),u=e.replace(/\.[^/.]+$/,"");o.html(`\n\t\t\t\t<span class="file-name">${u}</span>\n\t\t\t\t<button class="play-btn" data-file="${e}" data-type="${s}">Play</button>\n\t\t\t`),o.find(".play-btn").on("click",(function(){!async function(e,o){const s=o+"/"+e;if("audio"===o){i=[],a=!1;const n=e.replace(/\.[^/.]+$/,"");$("#track-title").text(n),f(!1);try{const e=await c(s),a=$("#audio-player")[0];a.src=e.blobUrl,await new Promise(((t,n)=>{a.addEventListener("loadedmetadata",t,{once:!0}),a.addEventListener("error",n,{once:!0}),setTimeout((()=>n(new Error("Metadata loading timeout"))),5e3)})),await a.play(),t=a,$("#track-title").text(n),b(!0),f(!0)}catch(t){$("#track-title").text(n+" (Error)"),f(!1)}}else if("music"===o)try{const t=await c(s),e=$("#music-player")[0];e.src=t.blobUrl,await new Promise(((t,n)=>{e.addEventListener("loadedmetadata",t,{once:!0}),e.addEventListener("error",n,{once:!0}),setTimeout((()=>n(new Error("Metadata loading timeout"))),5e3)})),await e.play(),n=e,m(!0)}catch(t){}}($(this).data("file"),$(this).data("type")),$(".modal").removeClass("active")})),r.append(o)})):r.append('<p class="no-files">No files found</p>')}function l(){t&&(t.paused?t.play().then((function(){b(!0)})).catch((function(t){})):(t.pause(),b(!1)),p())}function d(n){if(t){const e=Math.max(0,t.currentTime+n);s(t,e,(function(){}))}}function f(t){$("#back-15-btn").prop("disabled",!t),$("#play-pause-btn").prop("disabled",!t),$("#forward-15-btn").prop("disabled",!t)}function p(){const n=$("#play-pause-btn");t&&!t.paused?n.text("⏸"):n.text("▶")}function m(t){const e=$("#music-control-btn");if(n){e.prop("disabled",!1);const t=!n.paused;e.text(t?"⏸":"▶")}else e.prop("disabled",!0),e.text("▶")}function b(t){t?$("#main-player-area").addClass("playing"):$("#main-player-area").removeClass("playing"),p()}function h(){if(!t)return;const n=t.currentTime,e=t.duration;isNaN(n)||isNaN(e)||($("#current-time").text(w(n)),$("#total-time").text(w(e)),$("#track-duration").text(`${w(n)} / ${w(e)}`))}function y(n){if(!t)return;const e=$("#scrubber-bar")[0].getBoundingClientRect(),a=(n.type.includes("touch")?n.touches[0].clientX:n.clientX)-e.left,i=Math.max(0,Math.min(1,a/e.width)),o=i*t.duration;s(t,o,(function(){}));const c=100*i;$("#scrubber-progress").css("width",c+"%"),$("#scrubber-handle").css("left",c+"%"),$("#current-time").text(w(o)),$("#track-duration").text(`${w(o)} / ${w(t.duration)}`)}function w(t){if(isNaN(t))return"00:00";const n=Math.floor(t/60),e=Math.floor(t%60);return`${n.toString().padStart(2,"0")}:${e.toString().padStart(2,"0")}`}u("audio-files-list",window.audioFiles||[],"audio"),u("music-files-list",window.musicFiles||[],"music"),$("#main-player-area").on("click",(function(t){$(t.target).closest("#controls").length||l()})),$("#audio-files-btn").on("click",(function(){$("#audio-files-modal").addClass("active")})),$("#music-files-btn").on("click",(function(){$("#music-files-modal").addClass("active")})),$("#back-15-btn").on("click",(function(){d(-15)})),$("#play-pause-btn").on("click",(function(){l()})),$("#forward-15-btn").on("click",(function(){d(15)})),$("#music-control-btn").on("click",(function(){n&&(n.paused?n.play().then((function(){m(!0)})).catch((function(t){})):(n.pause(),m(!1)))})),$(".close-btn").on("click",(function(){$(".modal").removeClass("active")})),$(".modal").on("click",(function(t){t.target===this&&$(this).removeClass("active")})),$("#scrubber-bar").on("mousedown touchstart",(function(t){e=!0,y(t)})),$(document).on("mousemove touchmove",(function(t){e&&y(t)})),$(document).on("mouseup touchend",(function(){e&&(e=!1)})),function(){const n=$("#audio-player")[0],a=$("#music-player")[0];n.addEventListener("loadedmetadata",(function(){h()})),n.addEventListener("timeupdate",(function(){h(),function(){if(!t||e)return;const n=t.currentTime,a=t.duration;if(!isNaN(n)&&!isNaN(a)&&a>0){const t=n/a*100;$("#scrubber-progress").css("width",t+"%"),$("#scrubber-handle").css("left",t+"%")}}()})),n.addEventListener("ended",(function(){b(!1)})),a.addEventListener("loadedmetadata",(function(){})),a.addEventListener("ended",(function(){a.currentTime=0,a.play()}))}()}));