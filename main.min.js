cl=console.log,$(document).ready((function(){let t=null,n=null,e=!1,o=!1,i=[],a=new Map,c=0,s=0,r=0,u=0,l=50;async function d(t){const n=t;if(a.has(n))return a.get(n);try{const e=await fetch(t);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const o=await e.blob(),i=URL.createObjectURL(o);return a.set(n,{blobUrl:i,size:o.size,originalPath:t}),a.get(n)}catch(t){throw t}}function f(t,n,e){if(o)return void i.push({time:n,callback:e});o=!0;const a=!t.paused;a&&t.pause(),t.currentTime=n,setTimeout((()=>{o=!1,a?t.play().then((function(){e(),m()})).catch((function(t){e(),m()})):(e(),m())}),10)}function m(){if(i.length>0&&!o){const n=i.shift();f(t,n.time,n.callback)}}function p(e,a,c){const s=$("#"+e);s.empty(),0!==a.length?a.forEach((function(e){const a=$('<div class="file-item"></div>'),r=e.replace(/\.[^/.]+$/,"");a.html(`\n\t\t\t\t<span class="file-name">${r}</span>\n\t\t\t\t<button class="play-btn" data-file="${e}" data-type="${c}">Play</button>\n\t\t\t`),a.find(".play-btn").on("click",(function(){!async function(e,a){const c=a+"/"+e;if("_audio"===a){i=[],o=!1;const n=e.replace(/\.[^/.]+$/,"");$("#track-title").text(n),v(!1);try{const e=await d(c),o=$("#audio-player")[0];o.src=e.blobUrl,await new Promise(((t,n)=>{o.addEventListener("loadedmetadata",t,{once:!0}),o.addEventListener("error",n,{once:!0}),setTimeout((()=>n(new Error("Metadata loading timeout"))),5e3)})),await o.play(),t=o,$("#track-title").text(n),g(!0),v(!0)}catch(t){$("#track-title").text(n+" (Error)"),v(!1)}}else if("_music"===a)try{const t=await d(c),e=$("#music-player")[0];e.src=t.blobUrl,await new Promise(((t,n)=>{e.addEventListener("loadedmetadata",t,{once:!0}),e.addEventListener("error",n,{once:!0}),setTimeout((()=>n(new Error("Metadata loading timeout"))),5e3)})),await e.play(),n=e,y(!0)}catch(t){}}($(this).data("file"),$(this).data("type")),$(".modal").removeClass("active")})),s.append(a)})):s.append('<p class="no-files">No files found</p>')}function h(){t&&(t.paused?t.play().then((function(){g(!0)})).catch((function(t){})):(t.pause(),g(!1)),w())}function b(n){if(t){const e=Math.max(0,t.currentTime+n);f(t,e,(function(){}))}}function v(t){$("#back-10-btn").prop("disabled",!t),$("#play-pause-btn").prop("disabled",!t),$("#forward-10-btn").prop("disabled",!t)}function w(){const n=$("#play-pause-btn");t&&!t.paused?n.text("⏸"):n.text("▶")}function y(t){const e=$("#music-control-btn");if(n){e.prop("disabled",!1);const t=!n.paused;e.text(t?"⏸":"▶")}else e.prop("disabled",!0),e.text("▶")}function g(t){t?$("#main-player-area").addClass("playing"):$("#main-player-area").removeClass("playing"),w()}function E(){if(!t)return;const n=t.currentTime,e=t.duration;isNaN(n)||isNaN(e)||($("#current-time").text(T(n)),$("#total-time").text(T(e)),$("#track-duration").text(`${T(n)} / ${T(e)}`))}function k(n){if(!t)return;const e=$("#scrubber-bar")[0].getBoundingClientRect(),o=(n.type.includes("touch")?n.touches[0].clientX:n.clientX)-e.left,i=Math.max(0,Math.min(1,o/e.width)),a=i*t.duration;f(t,a,(function(){}));const c=100*i;$("#scrubber-progress").css("width",c+"%"),$("#scrubber-handle").css("left",c+"%"),$("#current-time").text(T(a)),$("#track-duration").text(`${T(a)} / ${T(t.duration)}`)}function T(t){if(isNaN(t))return"00:00";const n=Math.floor(t/60),e=Math.floor(t%60);return`${n.toString().padStart(2,"0")}:${e.toString().padStart(2,"0")}`}p("audio-files-list",window.audioFiles||[],"_audio"),p("music-files-list",window.musicFiles||[],"_music"),$("#main-player-area").on("click",(function(t){$(t.target).closest("#controls, #top-controls").length||h()})),$("#main-player-area").on("touchstart",(function(t){c=t.originalEvent.touches[0].clientX,s=t.originalEvent.touches[0].clientY})),$("#main-player-area").on("touchend",(function(t){r=t.originalEvent.changedTouches[0].clientX,u=t.originalEvent.changedTouches[0].clientY;const n=r-c,e=u-s;Math.abs(n)>Math.abs(e)&&Math.abs(n)>l&&(t.preventDefault(),b(n>0?-10:10))})),$("#audio-files-btn").on("click",(function(){$("#audio-files-modal").addClass("active")})),$("#music-files-btn").on("click",(function(){$("#music-files-modal").addClass("active")})),$("#back-10-btn").on("click",(function(){b(-10)})),$("#play-pause-btn").on("click",(function(){h()})),$("#forward-10-btn").on("click",(function(){b(10)})),$("#music-control-btn").on("click",(function(){n&&(n.paused?n.play().then((function(){y(!0)})).catch((function(t){})):(n.pause(),y(!1)))})),$("#audio-volume").on("input",(function(){const n=$(this).val()/100;t&&(t.volume=n)})),$("#music-volume").on("input",(function(){const t=$(this).val()/100;n&&(n.volume=t)})),$(".close-btn").on("click",(function(){$(".modal").removeClass("active")})),$(".modal").on("click",(function(t){t.target===this&&$(this).removeClass("active")})),$("#scrubber-bar").on("mousedown touchstart",(function(t){e=!0,k(t)})),$(document).on("mousemove touchmove",(function(t){e&&k(t)})),$(document).on("mouseup touchend",(function(){e&&(e=!1)})),function(){const n=$("#audio-player")[0],o=$("#music-player")[0];n.addEventListener("loadedmetadata",(function(){E()})),n.addEventListener("timeupdate",(function(){E(),function(){if(!t||e)return;const n=t.currentTime,o=t.duration;if(!isNaN(n)&&!isNaN(o)&&o>0){const t=n/o*100;$("#scrubber-progress").css("width",t+"%"),$("#scrubber-handle").css("left",t+"%")}}()})),n.addEventListener("ended",(function(){g(!1)})),o.addEventListener("loadedmetadata",(function(){})),o.addEventListener("ended",(function(){o.currentTime=0,o.play()}))}(),function(){if(/iPad|iPhone|iPod/.test(navigator.userAgent)){const t=()=>{const t=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",`${t}px`)};t(),window.addEventListener("resize",t),window.addEventListener("orientationchange",(()=>{setTimeout(t,100)}));let n=0;document.addEventListener("touchend",(function(t){const e=(new Date).getTime();e-n<=300&&t.preventDefault(),n=e}),!1),document.body.addEventListener("touchmove",(function(t){t.target.closest(".modal-body")||t.preventDefault()}),{passive:!1}),setTimeout((()=>{window.scrollTo(0,1),setTimeout((()=>{window.scrollTo(0,0)}),100)}),100)}}()}));